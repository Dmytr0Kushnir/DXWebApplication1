@using DXWebApplication1.Models
@using MongoDB.Bson.Serialization.Attributes;
@using MongoDB.Bson;

@model  List<ProjectModel>

@{
    ViewBag.Title = "Index";
}

<h2>KeyStone</h2>
<script>
    function OnRichEditControlInit(s, e) {
        RichEdit.commands.updateAllFields.execute();
    }

    function OnProtectDocumentClick(s, e) {
        RichEdit.PerformCallback({ actioName: "protectDocumentFields" });
    }

    function OnUpdateProtectedFields(s, e) {
        RichEdit.PerformCallback({ actioName: "updateProtectedFields" });
    }

    function onCityChanged(comboBox) {
    var Id = comboBox.GetValue();
    $.ajax({
        url: '@Url.Action("ProjectSelected", "Home")',
        type: 'POST',
        data: { Id: Id },
        success: function (response) {
            console.log(response);
            var richEdit = DevExpress.RichEdit.Get("RichEdit"); // Get the Rich Text Editor instance by its ID
            // Refresh the editor by reloading the current document
            richEdit.reload(); // This will refresh the editor's content
        },
        error: function (xhr, status, error) {
            console.error("Error: " + error);
        }
    });
}
</script>

@Html.DevExpress().ComboBox(settings =>
{
    settings.Name = "SelectProject";
    settings.Properties.ValueType = typeof(ObjectId);
    settings.Properties.TextField = "ProjectName";
    settings.Properties.ValueField = "Id";
    settings.Properties.ClientSideEvents.SelectedIndexChanged = "function(s, e) { onCityChanged(s,e); }";
}).BindList(Model).Bind(Model).GetHtml()


@Html.Action("RichEditPartial")
