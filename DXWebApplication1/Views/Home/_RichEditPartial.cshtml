@using DevExpress.XtraRichEdit;
@using DevExpress.XtraRichEdit.API.Native;
@using System.Drawing;
@using System.Web.UI.WebControls;
@using DXWebApplication1.Controllers;

@Html.DevExpress().RichEdit(settings =>
{
    settings.Name = "RichEdit";
    settings.CallbackRouteValues = new { Controller = "Home", Action = "RichEditPartial" };
    settings.Width = System.Web.UI.WebControls.Unit.Percentage(100);
    settings.Height = System.Web.UI.WebControls.Unit.Pixel(800);
    settings.ReadOnly = false;
    settings.WorkDirectory = "~\\Documents";
    settings.RibbonMode = RichEditRibbonMode.Ribbon;

    settings.Settings.Authentication.Group = "User";
    settings.Settings.Authentication.UserName = "User";
    settings.Settings.RangePermissions.HighlightColor = Color.Indigo;
    settings.Settings.RangePermissions.HighlightBracketsColor = Color.Purple;


    settings.Settings.Views.ViewType = DevExpress.Web.ASPxRichEdit.RichEditViewType.PrintLayout;

    settings.CalculateDocumentVariable = (send, evargs) =>
    {
        MVCxRichEdit richEdit = send as MVCxRichEdit;
        if (evargs.VariableName == "SomeField1")
        {
            evargs.Value = "CALCULATED FIELD 1";
            evargs.Handled = true;
        }
        if (evargs.VariableName == "SomeField2")
        {
            evargs.Value = "CALCULATED FIELD 2";
            evargs.Handled = true;
        }
    };
    settings.ClientSideEvents.Init = "function(s, e) {onInit(s, e); }"; ;

    //settings.ClientSideEvents.DocumentLoaded = "function(s, e) {onDocumentLoaded(s, e); }";
}).Open(Server.MapPath("~\\Documents\\testDOC1.doc")).GetHtml()